webpackJsonp([1],{147:function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}n.d(e,"a",function(){return c});var a=n(39),s=n.n(a),u=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),c=function(t){function e(t){i(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.preV={x:null,y:null},n.pinchStartLen=null,n.scale=1,n.isDoubleTap=!1,n.delta=null,n.last=null,n.now=null,n.tapTimeout=null,n.longTapTimeout=null,n.swipeTimeout=null,n.x1=n.x2=n.y1=n.y2=null,n.preTapPosition={x:null,y:null},n}return r(e,t),u(e,[{key:"getLen",value:function(t){return Math.sqrt(t.x*t.x+t.y*t.y)}},{key:"dot",value:function(t,e){return t.x*e.x+t.y*e.y}},{key:"getAngle",value:function(t,e){var n=getLen(t)*getLen(e);if(0===n)return 0;var i=dot(t,e)/n;return i>1&&(i=1),Math.acos(i)}},{key:"cross",value:function(t,e){return t.x*e.y-e.x*t.y}},{key:"getRotateAngle",value:function(t,e){var n=getAngle(t,e);return cross(t,e)>0&&(n*=-1),180*n/Math.PI}},{key:"_resetState",value:function(){this.setState({x:null,y:null,swiping:!1,start:0})}},{key:"_emitEvent",value:function(t,e){this.props[t]&&this.props[t](e)}},{key:"_handleTouchStart",value:function(t){t.persist(),this.now=Date.now(),this.x1=t.touches[0].pageX,this.y1=t.touches[0].pageY,this.delta=this.now-(this.last||this.now),null!==this.preTapPosition.x&&(this.isDoubleTap=this.delta>0&&this.delta<=250&&Math.abs(this.preTapPosition.x-this.x1)<30&&Math.abs(this.preTapPosition.y-this.y1)<30),this.preTapPosition.x=this.x1,this.preTapPosition.y=this.y1,this.last=this.now;var e=this.preV;if(t.touches.length>1){var n={x:t.touches[1].pageX-this.x1,y:t.touches[1].pageY-this.y1};e.x=n.x,e.y=n.y,this.pinchStartLen=getLen(e),this._emitEvent("onMultipointStart",t)}this.longTapTimeout=setTimeout(function(){this._emitEvent("onLongTap",t)}.bind(this),750)}},{key:"_handleTouchMove",value:function(t){t.persist();var e=this.preV,n=t.touches.length,i=t.touches[0].pageX,o=t.touches[0].pageY;if(this.isDoubleTap=!1,n>1){var r={x:t.touches[1].pageX-i,y:t.touches[1].pageY-o};null!==e.x&&(this.pinchStartLen>0&&(t.scale=getLen(r)/this.pinchStartLen,this._emitEvent("onPinch",t)),t.angle=getRotateAngle(r,e),this._emitEvent("onRotate",t)),e.x=r.x,e.y=r.y}else null!==this.x2?(t.deltaX=i-this.x2,t.deltaY=o-this.y2):(t.deltaX=0,t.deltaY=0),this._emitEvent("onPressMove",t);this._cancelLongTap(),this.x2=i,this.y2=o,n>1&&t.preventDefault()}},{key:"_handleTouchCancel",value:function(){clearInterval(this.tapTimeout),clearInterval(this.longTapTimeout),clearInterval(this.swipeTimeout)}},{key:"_handleTouchEnd",value:function(t){this._emitEvent("onTouchEnd",t),this._cancelLongTap();var e=this;t.touches.length<2&&this._emitEvent("onMultipointEnd",t),this.x2&&Math.abs(this.x1-this.x2)>30||this.y2&&Math.abs(this.preV.y-this.y2)>30?(t.direction=this._swipeDirection(this.x1,this.x2,this.y1,this.y2),this.swipeTimeout=setTimeout(function(){e._emitEvent("onSwipe",t)},0)):this.tapTimeout=setTimeout(function(){e._emitEvent("onTap",t),e.isDoubleTap&&(e._emitEvent("onDoubleTap",t),e.isDoubleTap=!1)},0),this.preV.x=0,this.preV.y=0,this.scale=1,this.pinchStartLen=null,this.x1=this.x2=this.y1=this.y2=null}},{key:"_cancelLongTap",value:function(){clearTimeout(this.longTapTimeout)}},{key:"_swipeDirection",value:function(t,e,n,i){return Math.abs(t-e)>=Math.abs(n-i)?t-e>0?"Left":"Right":n-i>0?"Up":"Down"}},{key:"render",value:function(){return s.a.cloneElement(s.a.Children.only(this.props.children),{onTouchStart:this._handleTouchStart.bind(this),onTouchMove:this._handleTouchMove.bind(this),onTouchCancel:this._handleTouchCancel.bind(this),onTouchEnd:this._handleTouchEnd.bind(this)})}}]),e}(s.a.Component)},214:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(39),o=n.n(i),r=n(453),a=(n.n(r),n(517)),s=(n.n(a),n(221));n.i(r.render)(o.a.createElement(a.AppContainer,null,o.a.createElement(s.a,null)),document.getElementById("root"))},221:function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(39),s=n.n(a),u=n(92),c=(n.n(u),n(147)),l=n(222),h=n(224),f=n(66),p=n(140),d=n(94),y=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),v=function(t){function e(t){i(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.y=0,n.x=0,n.state={inputShow:!1,style:{marginTop:"-16%"}},n}return r(e,t),y(e,[{key:"componentDidMount",value:function(){function t(t){var l=t.accelerationIncludingGravity,h=(new Date).getTime();if(h-c>100){var p=h-c;c=h,e=l.x,i=l.y,o=l.z;Math.abs(e+i+o-r-a-s)/p*1e4>u&&window.confirm("是否删除已完成条目")&&d.a.dispatch(n.i(f.a)()),r=e,a=i,s=o}}var e,i,o,r,a,s,u=1500,c=0;window.DeviceMotionEvent&&window.addEventListener("devicemotion",t,!1)}},{key:"addInputOnBlur",value:function(){this.setState({inputShow:!1,style:{marginTop:"-16%"}})}},{key:"onPressMove",value:function(t){this.y+=t.deltaY,this.x+=t.deltaX,this.y>20&&this.x<10&&this.inputInit()}},{key:"changeText",value:function(){this.inputInit(d.a.getState().modify.text)}},{key:"inputInit",value:function(t){l.a.focus(),t&&(l.a.value=t),this.setState({inputShow:!0,style:{marginTop:"0%"}})}},{key:"init",value:function(){this.x=0,this.y=0}},{key:"render",value:function(){return s.a.createElement(p.a,{store:d.a},s.a.createElement(c.a,{onPressMove:this.onPressMove.bind(this),onTouchEnd:this.init.bind(this),onLongTap:this.changeText.bind(this)},s.a.createElement("div",{className:n.i(u.css)(m.padding),style:this.state.style},s.a.createElement(l.b,{addInputOnBlur:this.addInputOnBlur.bind(this)}),s.a.createElement("div",{style:{transtion:"all .5s",display:this.state.inputShow?"none":"block"}},s.a.createElement(h.a,null)))))}}]),e}(s.a.Component),m=u.StyleSheet.create({padding:{padding:"5%",minHeight:"95%",transition:"all .3s"}});e.a=v},222:function(t,e,n){"use strict";n.d(e,"b",function(){return h}),n.d(e,"a",function(){return l});var i=n(39),o=n.n(i),r=n(140),a=n(66),s=n(92),u=(n.n(s),n(94)),c=n(75),l=void 0,h=function(t){var e=t.dispatch,i=t.addInputOnBlur;t.getState;return o.a.createElement("div",null,o.a.createElement("input",{className:n.i(s.css)(f.fontSize),ref:function(t){l=t},onBlur:function(t){if(i(),l.value.trim()){var o=u.a.getState();o.modify.flag?(window.fetch(c.a+"/todo/"+o.modify.id+"/",{method:"PUT",body:JSON.stringify({text:l.value,completed:o.todos.find(function(t){return t.id===o.modify.id}).completed})}),e(n.i(a.e)(o.modify.id,l.value))):(window.fetch(c.a+"/todo/",{method:"POST",body:JSON.stringify({text:l.value})}),e(n.i(a.f)(l.value))),e(n.i(a.g)()),l.value=""}},type:"text"}))};h=n.i(r.b)()(h);var f=s.StyleSheet.create({fontSize:{fontSize:"0.8rem",width:"100%",margin:0,padding:0,"-webkit-appearance":"caret"}})},223:function(t,e,n){"use strict";(function(t){function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=n(39),s=n.n(a),u=n(92),c=(n.n(u),n(147)),l=n(94),h=n(66),f=n(75),p=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},d=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),y=function(e){function a(t){i(this,a);var e=o(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,t));return e.x=0,e.y=0,e.hasSetedX=!1,e.state={style:{opacity:t.completed?.5:1,textDecoration:t.completed?"line-through":"none",marginLeft:0}},e.id=t.todoId,e.changeDone=t.changeDone,e.completed=t.completed,e.text=t.text,e}return r(a,e),d(a,[{key:"onPressMove",value:function(t){console.log(this.x,this.completed),this.x+=t.deltaX,this.y+=t.deltaY,t.deltaX>0&&this.y<10?this.rightSwip():t.deltaX<0&&this.y<10&&this.leftSwip()}},{key:"rightSwip",value:function(){this.x>20?!1===this.hasSetedX&&(this.completed=!this.completed,this.changeDone(),this.hasSetedX=!0):this.x<20&&this.x>0&&this.setOpacity(this.x)}},{key:"leftSwip",value:function(){this.x<-30?window.confirm("是否删除本条目？")?(window.fetch(f.a+"/todo/"+this.id+"/",{method:"DELETE"}),l.a.dispatch(n.i(h.c)(this.id))):this.init():this.x>-30&&this.x<0&&this.setMarginLeft(this.x)}},{key:"setMarginLeft",value:function(t){this.setState({style:{marginLeft:t+"px"}})}},{key:"setOpacity",value:function(t){this.completed?this.setState({style:{opacity:.01*(50+2.5*t)}}):this.setState({style:{opacity:.01*(100-2.5*t)}})}},{key:"init",value:function(){var e=this;t(function(){e.hasSetedX=!1,e.x=0,e.y=0,e.initOpacity(e.completed)})}},{key:"initOpacity",value:function(t){t?this.setState({style:{opacity:.5,textDecoration:"line-through"}}):this.setState({style:{opacity:1,textDecoration:"none"}})}},{key:"modify",value:function(t){return t.preventDefault(),l.a.dispatch(n.i(h.d)(this.id,this.props.text)),!1}},{key:"render",value:function(){return s.a.createElement(c.a,{onPressMove:this.onPressMove.bind(this),onTouchEnd:this.init.bind(this),onLongTap:this.modify.bind(this)},s.a.createElement("p",{className:n.i(u.css)(v.smallerFontSize),style:p({},this.state.style,{userSelect:"none",touchCallout:"none"})},this.props.text))}}]),a}(s.a.Component),v=u.StyleSheet.create({smallerFontSize:{fontSize:"0.8rem",width:"100%",display:"block","-webkit-touch-callout":"none"}});e.a=y}).call(e,n(553).setImmediate)},224:function(t,e,n){"use strict";function i(t){return t.todos}var o=n(39),r=n.n(o),a=n(223),s=n(66),u=n(140),c=n(75),l=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},h=function(t){var e=t.todos,n=t.changeDone;return r.a.createElement("div",null,e.map(function(t){return r.a.createElement(a.a,l({todoId:t.id,key:t.id},t,{changeDone:function(){window.fetch(c.a+"/todo/"+t.id+"/",{method:"PUT",body:JSON.stringify({text:t.text,completed:!t.completed})}),n(t.id)}}))}))},f=function(t){return{todos:i(t)}},p={changeDone:s.b};h=n.i(u.b)(f,p)(h),e.a=h},225:function(t,e,n){"use strict";var i=n(227),o=n(226),r=n(144),a=n.i(r.c)({todos:i.a,modify:o.a});e.a=a},226:function(t,e,n){"use strict";var i=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1];switch(e.type){case"MODIFY_ID":return{id:e.id,flag:!0,text:e.text};case"SET_FLAG_TO_FALSE":return{flag:!1};default:return t}};e.a=i},227:function(t,e,n){"use strict";function i(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},r=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments[1];switch(e.type){case"ADD_TODO":return[{id:e.id,text:e.text,completed:!1}].concat(i(t));case"TOGGLE_TODO":return t.map(function(t){return t.id===e.id?o({},t,{completed:!t.completed}):t});case"DELETE_TODO_HASCOMPLETED":return t.filter(function(t){return!1===t.completed});case"DELETE_TODO":return t.filter(function(t){return t.id!==e.id});case"MODIFY_TODO":return t.map(function(t){return t.id===e.id?o({},t,{text:e.text}):t});case"SET_TODO":return e.todoList;default:return t}};e.a=r},555:function(t,e,n){n(215),t.exports=n(214)},66:function(t,e,n){"use strict";n.d(e,"f",function(){return i}),n.d(e,"h",function(){return o}),n.d(e,"b",function(){return r}),n.d(e,"a",function(){return a}),n.d(e,"c",function(){return s}),n.d(e,"e",function(){return u}),n.d(e,"g",function(){return c}),n.d(e,"d",function(){return l});var i=function(t){return{type:"ADD_TODO",id:window.nextTodoId++,text:t}},o=function(t){return{type:"SET_TODO",todoList:t}},r=function(t,e){return{type:"TOGGLE_TODO",id:t}},a=function(){return{type:"DELETE_TODO_HASCOMPLETED"}},s=function(t){return{type:"DELETE_TODO",id:t}},u=function(t,e){return{type:"MODIFY_TODO",id:t,text:e}},c=function(){return{type:"SET_FLAG_TO_FALSE"}},l=function(t,e){return{type:"MODIFY_ID",id:t,text:e}}},75:function(t,e,n){"use strict";e.a="//120.77.37.119:8000"},94:function(t,e,n){"use strict";function i(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){function i(o,r){try{var a=e[o](r),s=a.value}catch(t){return void n(t)}if(!a.done)return Promise.resolve(s).then(function(t){i("next",t)},function(t){i("throw",t)});t(s)}return i("next")})}}var o=n(144),r=n(225),a=n(66),s=n(75),u=function(){var t=i(regeneratorRuntime.mark(function t(){var e,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,window.fetch(s.a+"/todo/");case 2:return e=t.sent,t.next=5,e.json();case 5:i=t.sent,console.log(i),window.nextTodoId=i[i.length-1].id+1,c.dispatch(n.i(a.h)(i));case 9:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),c=n.i(o.b)(r.a,{todos:[]},window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());u(),e.a=c}},[555]);